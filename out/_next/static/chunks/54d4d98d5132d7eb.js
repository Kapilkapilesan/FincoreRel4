(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95468,e=>{"use strict";let r=(0,e.i(75254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>r],95468)},73884,e=>{"use strict";let r=(0,e.i(75254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>r],73884)},72520,e=>{"use strict";let r=(0,e.i(75254).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>r],72520)},42920,e=>{"use strict";let r=(0,e.i(75254).default)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);e.s(["Building",()=>r],42920)},58386,e=>{"use strict";var r=e.i(64397);e.s(["centerRequestService",0,{getRequests:async e=>{try{let t=new URLSearchParams;e&&t.append("status",e);let a=t.toString(),s=`${r.API_BASE_URL}/center-requests${a?`?${a}`:""}`,d=await fetch(s,{headers:(0,r.getHeaders)()});if(!d.ok)return console.error("Fetch failed",d.status,d.statusText),[];let l=await d.json();return l.data?.data||[]}catch(e){throw console.error("Error fetching requests in service",e),e}},createRequest:async e=>{let t=await fetch(`${r.API_BASE_URL}/center-requests`,{method:"POST",headers:(0,r.getHeaders)(),body:JSON.stringify(e)}),a=await t.json();if(!t.ok)throw Error(a.message||"Failed to create request");return a},approveRequest:async(e,t)=>{let a=await fetch(`${r.API_BASE_URL}/center-requests/${e}/approve`,{method:"PATCH",headers:(0,r.getHeaders)(),body:JSON.stringify({remarks:t})}),s=await a.json();if(!a.ok)throw Error(s.message||"Failed to approve request");return s},rejectRequest:async(e,t)=>{let a=await fetch(`${r.API_BASE_URL}/center-requests/${e}/reject`,{method:"PATCH",headers:(0,r.getHeaders)(),body:JSON.stringify({remarks:t})}),s=await a.json();if(!a.ok)throw Error(s.message||"Failed to reject request");return s}}])},11041,e=>{"use strict";var r=e.i(43476),t=e.i(71645);let a=(0,e.i(75254).default)("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);var s=e.i(95468),d=e.i(73884),l=e.i(3116),i=e.i(84614),c=e.i(42920),n=e.i(72520),o=e.i(70319),x=e.i(58386),g=e.i(42365);function h(){let[e,h]=(0,t.useState)([]),[u,m]=(0,t.useState)(!0),[b,p]=(0,t.useState)("PENDING"),[y,f]=(0,t.useState)(null),[k,j]=(0,t.useState)({isOpen:!1,type:"approve",requestId:null,remarks:""}),v=g.authService.hasRole("manager")||g.authService.hasRole("admin")||g.authService.hasRole("super_admin");(0,t.useEffect)(()=>{N()},[b]);let N=async()=>{m(!0);try{let e=await x.centerRequestService.getRequests(b);h(e)}catch(e){console.error("Failed to load requests",e),o.toast.error("Failed to load requests")}finally{m(!1)}},w=async()=>{if(k.requestId){f(k.requestId);try{"approve"===k.type?(await x.centerRequestService.approveRequest(k.requestId,k.remarks),o.toast.success("Request approved successfully")):(await x.centerRequestService.rejectRequest(k.requestId,k.remarks),o.toast.success("Request rejected")),N(),j({...k,isOpen:!1,remarks:""})}catch(e){o.toast.error(e.message||"Action failed")}finally{f(null)}}},R=(e,r)=>{j({isOpen:!0,type:r,requestId:e,remarks:""})};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200 font-sans",children:[(0,r.jsxs)("main",{className:"py-8 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto space-y-8",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-black text-gray-900 dark:text-white tracking-tight",children:"Center Transfer Requests"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-2 font-medium",children:"Manage customer movement between centers"})]}),(0,r.jsx)("div",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 p-1 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm",children:["PENDING","APPROVED","REJECTED",""].map(e=>(0,r.jsx)("button",{onClick:()=>p(e),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${b===e?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 dark:text-gray-400"}`,children:e||"ALL"},e||"ALL"))})]}),u?(0,r.jsx)("div",{className:"flex justify-center py-20",children:(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})})}):0===e.length?(0,r.jsxs)("div",{className:"text-center py-20 bg-white dark:bg-gray-800 rounded-3xl border border-dashed border-gray-300 dark:border-gray-700",children:[(0,r.jsx)(a,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"No Requests Found"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"There are no center transfer requests matching your filter."})]}):(0,r.jsx)("div",{className:"grid gap-6",children:e.map(e=>(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700/50 hover:shadow-md transition-all relative overflow-hidden group",children:[(0,r.jsx)("div",{className:`absolute left-0 top-0 bottom-0 w-1.5 ${"PENDING"===e.status?"bg-orange-500":"APPROVED"===e.status?"bg-green-500":"bg-red-500"}`}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 lg:items-center justify-between pl-4",children:[(0,r.jsxs)("div",{className:"space-y-4 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-black uppercase tracking-wider ${"PENDING"===e.status?"bg-orange-100 text-orange-600 dark:bg-orange-900/30":"APPROVED"===e.status?"bg-green-100 text-green-600 dark:bg-green-900/30":"bg-red-100 text-red-600 dark:bg-red-900/30"}`,children:e.status}),(0,r.jsxs)("span",{className:"text-sm text-gray-400 flex items-center gap-1.5 font-medium",children:[(0,r.jsx)(l.Clock,{size:14}),new Date(e.created_at).toLocaleDateString()]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-3 rounded-xl",children:(0,r.jsx)(i.User,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:e.customer?.full_name}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono",children:e.customer?.customer_code})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl border border-gray-100 dark:border-gray-700/50 max-w-2xl",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 font-bold uppercase mb-1",children:"From"}),(0,r.jsxs)("p",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,r.jsx)(c.Building,{size:14,className:"text-gray-400"}),e.current_center?.center_name]})]}),(0,r.jsx)(n.ArrowRight,{className:"text-gray-300 dark:text-gray-600"}),(0,r.jsxs)("div",{className:"flex-1 text-right",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 font-bold uppercase mb-1",children:"To"}),(0,r.jsxs)("p",{className:"font-semibold text-blue-600 dark:text-blue-400 flex items-center justify-end gap-2",children:[e.requested_center?.center_name,(0,r.jsx)(c.Building,{size:14})]})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-blue-50/50 dark:bg-blue-900/10 rounded-xl text-sm text-gray-600 dark:text-gray-300 border-l-4 border-blue-400 max-w-2xl",children:[(0,r.jsx)("span",{className:"font-bold text-blue-800 dark:text-blue-300 block mb-1",children:"Reason for request:"}),'"',e.reason,'"']})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 min-w-[200px]",children:[(0,r.jsxs)("div",{className:"text-right mb-2",children:[(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"Requested by"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.requester?.user_name})]}),"PENDING"===e.status&&v?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>R(e.id,"approve"),disabled:!!y,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-sm shadow-lg shadow-blue-500/20 transition-all flex items-center justify-center gap-2",children:[(0,r.jsx)(s.CheckCircle2,{size:18}),"Approve Transfer"]}),(0,r.jsxs)("button",{onClick:()=>R(e.id,"reject"),disabled:!!y,className:"w-full py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:border-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-600 dark:text-gray-300 hover:text-red-600 dark:hover:text-red-400 rounded-xl font-bold text-sm transition-all flex items-center justify-center gap-2",children:[(0,r.jsx)(d.XCircle,{size:18}),"Reject"]})]}):"PENDING"!==e.status?(0,r.jsxs)("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl border border-gray-100 dark:border-gray-700 text-center",children:[(0,r.jsxs)("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:["Processed by ",e.approver?.user_name]}),e.remarks&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 italic",children:['"',e.remarks,'"']})]}):null]})]})]},e.id))})]}),k.isOpen&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-[150] p-4 animate-in fade-in duration-200",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-lg w-full shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden transform transition-all",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700/50 flex items-center justify-between bg-white/50 dark:bg-gray-800/50 backdrop-blur-xl",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:["approve"===k.type?(0,r.jsx)(s.CheckCircle2,{className:"w-5 h-5 text-blue-600"}):(0,r.jsx)(d.XCircle,{className:"w-5 h-5 text-red-600"}),"approve"===k.type?"Approve Transfer":"Reject Request"]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"approve"===k.type?"Update customer records and finalize transfer":"Deny this transfer request"})]}),(0,r.jsx)("button",{onClick:()=>j({...k,isOpen:!1}),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors text-gray-500",children:(0,r.jsx)(d.XCircle,{size:20})})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:["approve"===k.type&&(0,r.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/10 p-4 rounded-xl border border-blue-100 dark:border-blue-900/30 flex gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/40 rounded-lg h-fit",children:(0,r.jsx)(s.CheckCircle2,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-bold text-gray-900 dark:text-white",children:"Confirm Approval"}),(0,r.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 leading-relaxed",children:"This action will immediately transfer the customer to the new center. The customer's previous center assignment will be archived."})]})]}),"reject"===k.type&&(0,r.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/10 p-4 rounded-xl border border-red-100 dark:border-red-900/30 flex gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-red-100 dark:bg-red-900/40 rounded-lg h-fit",children:(0,r.jsx)(d.XCircle,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-bold text-gray-900 dark:text-white",children:"Reject Request"}),(0,r.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 leading-relaxed",children:"Please provide a reason for rejecting this transfer. This will be visible to the requester."})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"approve"===k.type?"Remarks (Optional)":"Reason for Rejection *"}),(0,r.jsx)("textarea",{value:k.remarks,onChange:e=>j({...k,remarks:e.target.value}),className:"w-full p-3 bg-gray-50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none min-h-[100px] transition-all",placeholder:"approve"===k.type?"Add any notes...":"Explain why this request is being rejected...",autoFocus:"reject"===k.type})]})]}),(0,r.jsxs)("div",{className:"p-6 border-t border-gray-100 dark:border-gray-700/50 flex justify-end gap-3 bg-gray-50/50 dark:bg-gray-800/50",children:[(0,r.jsx)("button",{onClick:()=>j({...k,isOpen:!1}),className:"px-4 py-2 text-gray-600 dark:text-gray-300 font-medium hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:w,disabled:null!==y||"reject"===k.type&&!k.remarks.trim(),className:`px-6 py-2 font-bold rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 ${"approve"===k.type?"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-500/20":"bg-red-600 hover:bg-red-700 text-white shadow-red-500/20"}`,children:y?(0,r.jsx)(r.Fragment,{children:"Processing..."}):(0,r.jsxs)(r.Fragment,{children:["approve"===k.type?(0,r.jsx)(s.CheckCircle2,{size:18}):(0,r.jsx)(d.XCircle,{size:18}),"approve"===k.type?"Confirm Approval":"Reject Request"]})})]})]})})]})}e.s(["default",()=>h],11041)}]);
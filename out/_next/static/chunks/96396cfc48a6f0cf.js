(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,28475,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(42365),s=e.i(75254);let l=(0,s.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var i=e.i(7486),n=e.i(61911),o=e.i(14606),d=e.i(84614),c=e.i(78583),x=e.i(12426);let g=(0,s.default)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),u=(0,s.default)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var m=e.i(52754),h=e.i(25652),p=e.i(39616),y=e.i(64659);let b=(0,s.default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var f=e.i(98919),v=e.i(63209);let k=(0,s.default)("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),w=(0,s.default)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var j=e.i(73375),N=e.i(63059),S=e.i(40160);let C=(0,s.default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);var M=e.i(86311),$=e.i(17646),L=e.i(81418),P=e.i(67240);function F({currentPage:e,onNavigate:s,isOpen:F,userRole:O}){let[T,z]=r.default.useState(["loans","collections-section","finance"]),[D,R]=r.default.useState(!1),[_,I]=r.default.useState(!1);r.default.useEffect(()=>{I(!0)},[]);let E=[{id:"dashboard",label:"Dashboard",icon:(0,t.jsx)(l,{className:"w-5 h-5"}),permission:"dashboard.view"},{id:"branches",label:"Branches",icon:(0,t.jsx)(i.Building2,{className:"w-5 h-5"}),permission:"branches.view"},{id:"centers-section",label:"Centers (CSU)",icon:(0,t.jsx)(n.Users,{className:"w-5 h-5"}),submenu:[{id:"centers",label:"Schedule",icon:(0,t.jsx)(g,{className:"w-4 h-4"})},{id:"meeting-scheduling",label:"Meeting Schedule",icon:(0,t.jsx)(g,{className:"w-4 h-4"}),roles:["super_admin","admin","manager","staff"]},{id:"center-requests",label:"Transfer Requests",icon:(0,t.jsx)(k,{className:"w-4 h-4"}),roles:["super_admin","admin","manager"]}],permission:"centers.view"},{id:"groups",label:"Groups",icon:(0,t.jsx)(o.UsersRound,{className:"w-5 h-5"}),permission:"groups.view"},{id:"customers-section",label:"Customers",icon:(0,t.jsx)(d.User,{className:"w-5 h-5"}),submenu:[{id:"customers",label:"Customer List",icon:(0,t.jsx)(g,{className:"w-4 h-4"})},{id:"customer-requests",label:"Edit Approvals",icon:(0,t.jsx)(L.ShieldCheck,{className:"w-4 h-4"}),roles:["super_admin","admin","manager"]}],permission:"customers.view"},{id:"shareholders",label:"Shareholders",icon:(0,t.jsx)($.PieChart,{className:"w-5 h-5"})}],A=[{id:"loan-product",label:"Loan",icon:(0,t.jsx)(x.DollarSign,{className:"w-4 h-4"})},{id:"investments",label:"Investment",icon:(0,t.jsx)(h.TrendingUp,{className:"w-4 h-4"})}],U=[{id:"loan-create",label:"Create Loan",icon:(0,t.jsx)(c.FileText,{className:"w-4 h-4"}),permission:"loans.create"},{id:"loan-approval",label:"Loan Approval",icon:(0,t.jsx)(f.Shield,{className:"w-4 h-4"}),permission:"loans.approve"},{id:"loan-sent-back",label:"Sent Back Loans",icon:(0,t.jsx)(v.AlertCircle,{className:"w-4 h-4"}),permission:"loans.view"},{id:"loan-list",label:"Loan List",icon:(0,t.jsx)(g,{className:"w-4 h-4"}),permission:"loans.view"}],W=[{id:"due-list",label:"Due List",icon:(0,t.jsx)(g,{className:"w-4 h-4"}),permission:"collections.view"},{id:"collections",label:"Collections",icon:(0,t.jsx)(x.DollarSign,{className:"w-4 h-4"}),permission:"collections.view"},{id:"receipt-rejections",label:"Cancellation Requests",icon:(0,t.jsx)(P.RotateCcw,{className:"w-4 h-4"}),permission:"receipts.approvecancel"},{id:"collection-summary",label:"Collection Summary",icon:(0,t.jsx)(w,{className:"w-4 h-4"}),permission:"collections.view"}],q=[{id:"finance",label:"Finance Overview",icon:(0,t.jsx)(m.Wallet,{className:"w-4 h-4"}),permission:"finance.view"},{id:"fund-transactions",label:"Fund Transactions",icon:(0,t.jsx)(k,{className:"w-4 h-4"}),permission:"finance.transactions"},{id:"branch-transactions",label:"Branch Transactions",icon:(0,t.jsx)(i.Building2,{className:"w-4 h-4"}),permission:"finance.view"}],B=e=>{D||z(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},H=r=>{if(r.roles&&!r.roles.includes(O))return null;let l=r.submenu&&r.submenu.length>0,i=T.includes(r.id);if(r.permission&&(!_||!a.authService.hasPermission(r.permission)))return null;let n=e===r.id;return l?(0,t.jsx)("div",{children:D?(0,t.jsxs)("button",{onClick:()=>B(r.id),className:`w-full flex items-center justify-center px-3 py-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all group relative ${n?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""}`,title:r.label,children:[(0,t.jsx)("div",{className:`${n?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"} group-hover:text-gray-700 dark:group-hover:text-gray-300`,children:r.icon}),(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:r.label})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>B(r.id),className:`w-full flex items-center justify-between px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all group ${n?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`${n?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"} group-hover:text-gray-700 dark:group-hover:text-gray-300`,children:r.icon}),(0,t.jsx)("span",{className:"text-sm font-medium",children:r.label})]}),(0,t.jsx)(y.ChevronDown,{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`})]}),i&&(0,t.jsx)("div",{className:"ml-8 mt-1 space-y-0.5 border-l-2 border-gray-200 dark:border-gray-700 pl-2",children:r.submenu?.map(r=>{if(r.roles&&!r.roles.includes(O)||r.permission&&(!_||!a.authService.hasPermission(r.permission)))return null;let l=e===r.id;return(0,t.jsxs)("button",{onClick:()=>s(r.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-md transition-all text-sm ${l?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[r.icon,(0,t.jsx)("span",{children:r.label})]},r.id)})})]})},r.id):(0,t.jsxs)("button",{onClick:()=>s(r.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative ${n?"bg-blue-600 text-white shadow-sm":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:D?r.label:"",children:[(0,t.jsx)("div",{className:`${n?"text-white":"text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300"}`,children:r.icon}),!D&&(0,t.jsx)("span",{className:"text-sm font-medium truncate",children:r.label}),D&&(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:r.label})]},r.id)};return(0,t.jsxs)("aside",{className:`
      fixed lg:static inset-y-0 left-0 z-50
      ${D?"w-20":"w-64"} bg-white dark:bg-gray-800 flex flex-col border-r border-gray-200 dark:border-gray-700
      transform transition-all duration-300 ease-in-out
      ${F?"translate-x-0":"-translate-x-full"}
      lg:translate-x-0
    `,children:[(0,t.jsx)("div",{className:`p-4 border-b border-gray-200 dark:border-gray-700 ${D?"px-3":"px-4"}`,children:(0,t.jsxs)("div",{className:`flex items-center ${D?"justify-center":"gap-3"}`,children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-sm flex-shrink-0",children:(0,t.jsx)(i.Building2,{className:"w-5 h-5 text-white"})}),!D&&(0,t.jsxs)("div",{className:"overflow-hidden",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 tracking-tight",children:"LMS"}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 font-medium uppercase tracking-wide",children:"Microfinance"})]})]})}),(0,t.jsxs)("nav",{className:"flex-1 overflow-y-auto px-3 py-4 space-y-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:[!D&&(0,t.jsx)("div",{className:"px-3 mb-2",children:(0,t.jsx)("p",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Main"})}),E.map(H),(0,t.jsxs)("div",{className:"pt-3",children:[!D&&(0,t.jsx)("div",{className:"px-3 mb-2",children:(0,t.jsx)("p",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Product"})}),D?(0,t.jsxs)("button",{onClick:()=>B("products"),className:"w-full flex items-center justify-center px-3 py-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all group relative",title:"Product",children:[(0,t.jsx)(C,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300"}),(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Product"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>B("products"),className:"w-full flex items-center justify-between px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(C,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Product"})]}),(0,t.jsx)(y.ChevronDown,{className:`w-4 h-4 transition-transform ${T.includes("products")?"rotate-180":""}`})]}),T.includes("products")&&(0,t.jsx)("div",{className:"ml-8 mt-1 space-y-0.5 border-l-2 border-gray-200 dark:border-gray-700 pl-2",children:A.map(r=>{let a=e===r.id;return(0,t.jsxs)("button",{onClick:()=>s(r.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-md transition-all text-sm ${a?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[r.icon,(0,t.jsx)("span",{children:r.label})]},r.id)})})]})]}),(0,t.jsxs)("div",{className:"pt-3",children:[!D&&(0,t.jsx)("div",{className:"px-3 mb-2",children:(0,t.jsx)("p",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Loans"})}),D?(0,t.jsxs)("button",{onClick:()=>B("loans"),className:"w-full flex items-center justify-center px-3 py-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all group relative",title:"Loans",children:[(0,t.jsx)(c.FileText,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300"}),(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Loans"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>B("loans"),className:"w-full flex items-center justify-between px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(c.FileText,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Loans"})]}),(0,t.jsx)(y.ChevronDown,{className:`w-4 h-4 transition-transform ${T.includes("loans")?"rotate-180":""}`})]}),T.includes("loans")&&(0,t.jsx)("div",{className:"ml-8 mt-1 space-y-0.5 border-l-2 border-gray-200 dark:border-gray-700 pl-2",children:U.map(r=>{if(r.roles&&!r.roles.includes(O)||r.permission&&(!_||!a.authService.hasPermission(r.permission)))return null;let l=e===r.id;return(0,t.jsxs)("button",{onClick:()=>s(r.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-md transition-all text-sm ${l?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[r.icon,(0,t.jsx)("span",{children:r.label})]},r.id)})})]})]}),(0,t.jsxs)("div",{className:"pt-3",children:[!D&&(0,t.jsx)("div",{className:"px-3 mb-2",children:(0,t.jsx)("p",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Collections"})}),H({id:"collections-section",label:"Collections",icon:(0,t.jsx)(x.DollarSign,{className:"w-5 h-5"}),submenu:W})]}),!D&&(0,t.jsx)("div",{className:"px-3 mb-2 pt-3",children:(0,t.jsx)("p",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Analytics"})}),(0,t.jsxs)("button",{onClick:()=>s("reports"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative ${"reports"===e?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-100"}`,title:D?"Reports":"",children:[(0,t.jsx)("div",{className:`${"reports"===e?"text-white":"text-gray-500 group-hover:text-gray-700"}`,children:(0,t.jsx)(u,{className:"w-5 h-5"})}),!D&&(0,t.jsx)("span",{className:"text-sm font-medium",children:"Reports"}),D&&(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Reports"})]}),(0,t.jsxs)("div",{className:"pt-3",children:[!D&&(0,t.jsx)("div",{className:"px-3 mb-2",children:(0,t.jsx)("p",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Finance"})}),D?(0,t.jsxs)("button",{onClick:()=>B("finance"),className:"w-full flex items-center justify-center px-3 py-2.5 text-gray-700 hover:bg-gray-100 rounded-lg transition-all group relative",title:"Finance",children:[(0,t.jsx)(m.Wallet,{className:"w-5 h-5 text-gray-500 group-hover:text-gray-700"}),(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Finance"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>B("finance"),className:"w-full flex items-center justify-between px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-all group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(m.Wallet,{className:"w-5 h-5 text-gray-500 group-hover:text-gray-700"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Finance"})]}),(0,t.jsx)(y.ChevronDown,{className:`w-4 h-4 transition-transform ${T.includes("finance")?"rotate-180":""}`})]}),T.includes("finance")&&(0,t.jsx)("div",{className:"ml-8 mt-1 space-y-0.5 border-l-2 border-gray-200 pl-2",children:q.map(r=>{if(r.roles&&!r.roles.includes(O)||r.permission&&(!_||!a.authService.hasPermission(r.permission)))return null;let l=e===r.id;return(0,t.jsxs)("button",{onClick:()=>s(r.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-md transition-all text-sm ${l?"bg-blue-50 text-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[r.icon,(0,t.jsx)("span",{children:r.label})]},r.id)})})]})]}),_&&a.authService.hasPermission("staff.view")&&(0,t.jsxs)("button",{onClick:()=>s("staff-management"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative ${"staff-management"===e?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-100"}`,title:D?"Staff Management":"",children:[(0,t.jsx)("div",{className:`${"staff-management"===e?"text-white":"text-gray-500 group-hover:text-gray-700"}`,children:(0,t.jsx)(n.Users,{className:"w-5 h-5"})}),!D&&(0,t.jsx)("span",{className:"text-sm font-medium",children:"Staff"}),D&&(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Staff Management"})]}),_&&a.authService.hasPermission("roles.view")&&(0,t.jsxs)("button",{onClick:()=>s("roles-privileges"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative ${"roles-privileges"===e?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-100"}`,title:D?"Roles & Privileges":"",children:[(0,t.jsx)("div",{className:`${"roles-privileges"===e?"text-white":"text-gray-500 group-hover:text-gray-700"}`,children:(0,t.jsx)(f.Shield,{className:"w-5 h-5"})}),!D&&(0,t.jsx)("span",{className:"text-sm font-medium",children:"Roles"}),D&&(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Roles & Privileges"})]}),(0,t.jsxs)("button",{onClick:()=>s("complaints"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative ${"complaints"===e?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-100"}`,title:D?"Complaints":"",children:[(0,t.jsx)("div",{className:`${"complaints"===e?"text-white":"text-gray-500 group-hover:text-gray-700"}`,children:(0,t.jsx)(M.MessageSquare,{className:"w-5 h-5"})}),!D&&(0,t.jsx)("span",{className:"text-sm font-medium",children:"Complaints"}),D&&(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Complaints"})]}),_&&a.authService.hasPermission("settings.view")&&(0,t.jsxs)(t.Fragment,{children:[!D&&(0,t.jsx)("div",{className:"px-3 mb-2 pt-3",children:(0,t.jsx)("p",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Settings"})}),(0,t.jsxs)("button",{onClick:()=>s("system-config"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative ${"system-config"===e?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-100"}`,title:D?"System Config":"",children:[(0,t.jsx)("div",{className:`${"system-config"===e?"text-white":"text-gray-500 group-hover:text-gray-700"}`,children:(0,t.jsx)(p.Settings,{className:"w-5 h-5"})}),!D&&(0,t.jsx)("span",{className:"text-sm font-medium",children:"System Config"}),D&&(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"System Config"})]})]}),(0,t.jsxs)("div",{className:"pt-2 mt-2 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("button",{onClick:()=>s("documents"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative mb-1 ${"documents"===e?"bg-blue-600 text-white shadow-sm":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:D?"Documents & Downloads":"",children:[(0,t.jsx)("div",{className:`${"documents"===e?"text-white":"text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300"}`,children:(0,t.jsx)(S.Download,{className:"w-5 h-5"})}),!D&&(0,t.jsx)("span",{className:"text-sm font-medium",children:"Documents"}),D&&(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Documents & Downloads"})]}),(0,t.jsxs)("button",{onClick:()=>s("public-website"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative ${"public-website"===e?"bg-blue-600 text-white shadow-sm":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:D?"Public Website":"",children:[(0,t.jsx)("div",{className:`${"public-website"===e?"text-white":"text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300"}`,children:(0,t.jsx)(b,{className:"w-5 h-5"})}),!D&&(0,t.jsx)("span",{className:"text-sm font-medium",children:"Public Website"}),D&&(0,t.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity whitespace-nowrap z-50",children:"Public Website"})]})]})]}),(0,t.jsx)("div",{className:"hidden lg:block border-t border-gray-200 dark:border-gray-700 p-3",children:(0,t.jsx)("button",{onClick:()=>R(!D),className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-all group",children:D?(0,t.jsx)(N.ChevronRight,{className:"w-5 h-5"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.ChevronLeft,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Collapse"})]})})})]})}var O=e.i(18566);let T=(0,s.default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),z=(0,s.default)("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);var D=e.i(55436);let R=(0,s.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),_=(0,s.default)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),I=(0,s.default)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);var E=e.i(3116);let A=(0,r.createContext)(void 0);function U({children:e}){let[a,s]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{{let e="dark"===localStorage.getItem("theme")||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches;s(e),e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}},[]),(0,t.jsx)(A.Provider,{value:{isDarkMode:a,toggleTheme:()=>{s(e=>{let t=!e;return t?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")),t})}},children:e})}let W=()=>{let e=(0,r.useContext)(A);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e};var q=e.i(98094),B=e.i(70319);function H({user:e,onLogout:s,onToggleSidebar:l,onProfileSettings:i}){let[n,o]=(0,r.useState)(!1),[c,x]=(0,r.useState)(!1),[g,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),[p,b]=(0,r.useState)(null),[f,v]=(0,r.useState)(300),[k,w]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1),[M,$]=(0,r.useState)("0h 0m"),L=(0,r.useRef)(null),P=(0,r.useRef)(null),F=(0,O.usePathname)(),A=(0,O.useRouter)(),{isDarkMode:U,toggleTheme:H}=W(),V=a.authService.hasRole("super_admin")||a.authService.hasRole("admin"),[Y,G]=(0,r.useState)("office_work"),[K]=(0,r.useState)([{id:1,message:"3 loans pending approval",type:"warning",time:"10 min ago"},{id:2,message:"New collection completed",type:"success",time:"1 hour ago"},{id:3,message:"Payment reversal requested",type:"alert",time:"2 hours ago"}]);(0,r.useEffect)(()=>{o(!1),x(!1)},[F]),(0,r.useEffect)(()=>{if(n)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)};function e(e){L.current&&!L.current.contains(e.target)&&P.current&&!P.current.contains(e.target)&&o(!1)}},[n]);let J=(0,r.useCallback)(async()=>{if(!V)try{let[e,t]=await Promise.all([q.sessionService.getCurrentSession(),q.sessionService.getTodaySessions()]);if(t?.data&&($(q.sessionService.formatWorkedTime(t.data.total_worked_minutes)),t.data.should_show_midnight_warning&&h(!0)),e?.data?.session){let t=q.sessionService.getCurrentWorkStatus(e.data.session);G(t),e.data.should_show_midnight_warning&&h(!0)}}catch(e){console.error("Failed to fetch session data:",e)}},[V]);(0,r.useEffect)(()=>{if(V)return;J();let e=setInterval(J,3e5);return()=>clearInterval(e)},[J,V]),(0,r.useEffect)(()=>{if(V)return;let e=()=>{let e=new Date,t=e.getHours(),r=e.getMinutes();23===t&&r>=55&&!k&&(h(!0),w(!0),b("It is almost midnight. Please log out now to save your work. Your account will lock in 5 minutes."))},t=setInterval(e,1e4);return e(),()=>clearInterval(t)},[k,V]);let Z=async e=>{if(!S&&!V){C(!0);try{if("logged_out"===e){u(!0),C(!1);return}await a.authService.logout("on_field"===e?"ON_WORK":"STAY_IN_OFFICE"),s(),A.push("/login")}catch(e){console.error("Failed to update work status:",e)}finally{C(!1)}}},Q=async()=>{u(!1),o(!1);try{await a.authService.logout("LOGOUT"),s(),A.push("/login")}catch(e){console.error("Logout failed:",e),s(),A.push("/login")}},X=async()=>{o(!1);try{await a.authService.logout("LOGOUT"),s(),A.push("/login")}catch(e){console.error("Logout failed:",e),s(),A.push("/login")}},ee=()=>{h(!1)};(0,r.useEffect)(()=>{if(!k)return;let e=setInterval(()=>{v(t=>t<=1?(clearInterval(e),et(),0):t-1)},1e3);return()=>clearInterval(e)},[k]);let et=async()=>{if(!j){N(!0);try{await q.sessionService.midnightTimeoutLock(),B.toast.error("Your session has been discarded due to timeout. Your account is now locked. Please contact your manager to unlock.",{autoClose:!1}),s(),A.push("/login")}catch(e){console.error("Failed to lock account:",e),s(),A.push("/login")}finally{N(!1)}}};return(0,t.jsxs)(t.Fragment,{children:[m&&(0,t.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-md w-full mx-4 p-8",children:[(0,t.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,t.jsx)("div",{className:`w-20 h-20 rounded-full flex items-center justify-center ${f<=30?"bg-red-100 dark:bg-red-900/30":"bg-yellow-100 dark:bg-yellow-900/30"}`,children:(0,t.jsxs)("span",{className:`text-3xl font-bold ${f<=30?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-yellow-400"}`,children:[Math.floor(f/60),":",String(f%60).padStart(2,"0")]})})}),(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 text-center mb-2",children:f<=10?"⚠️ Account Lock Imminent!":"Midnight Approaching!"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-4",children:p||"It is almost midnight. Please log out to save your work hours."}),(0,t.jsxs)("div",{className:`p-3 rounded-xl text-center mb-6 ${f<=30?"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300":"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300"}`,children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:f<=30?`Your account will be LOCKED in ${f} seconds!`:`Time remaining: ${Math.floor(f/60)}m ${f%60}s`}),(0,t.jsx)("p",{className:"text-xs mt-1 opacity-80",children:"If you don't logout, your session will be discarded and your account will be locked."})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:ee,disabled:j,className:"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium disabled:opacity-50",children:"Dismiss"}),(0,t.jsx)("button",{onClick:()=>{ee(),Q()},disabled:j,className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium disabled:opacity-50",children:j?"Locking...":"Logout Now"})]})]})}),g&&(0,t.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-md w-full mx-4 p-8",children:[(0,t.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,t.jsx)("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:(0,t.jsx)(R,{className:"w-8 h-8 text-red-600 dark:text-red-400"})})}),(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 text-center mb-2",children:"End Your Work Day?"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-2",children:"If you logout, your session will be closed and your attendance will be recorded."}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-500 text-center mb-6",children:["Today's work: ",(0,t.jsx)("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:M})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium",children:"Cancel"}),(0,t.jsx)("button",{onClick:Q,className:"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors font-medium",children:"Yes, Logout"})]})]})}),(0,t.jsxs)("header",{className:"bg-white dark:bg-gray-800 h-16 flex items-center justify-between px-6 border-b border-gray-200 dark:border-gray-700 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors lg:hidden",children:(0,t.jsx)(T,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),(0,t.jsxs)("div",{className:"relative hidden md:block",children:[(0,t.jsx)(D.Search,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 absolute left-3 top-1/2 -translate-y-1/2"}),(0,t.jsx)("input",{type:"text",placeholder:"Search customers, loans, contracts...",className:"pl-10 pr-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-transparent dark:border-gray-700 rounded-xl w-80 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white dark:focus:bg-gray-800 focus:border-blue-200 dark:focus:border-blue-600 transition-all text-sm text-gray-900 dark:text-gray-100"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[!V&&(0,t.jsxs)("div",{className:"hidden lg:flex items-center gap-2 px-3 py-1.5 bg-green-50 dark:bg-green-900/30 rounded-xl",children:[(0,t.jsx)(E.Clock,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,t.jsx)("span",{className:"text-sm text-green-700 dark:text-green-300 font-medium",children:M})]}),(0,t.jsx)("div",{className:"hidden lg:flex items-center gap-2 px-4 py-2 bg-gray-50 dark:bg-gray-900 rounded-xl",children:(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:new Date().toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})}),(0,t.jsx)("button",{onClick:H,className:"p-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",title:U?"Switch to Light Mode":"Switch to Dark Mode",children:U?(0,t.jsx)(I,{className:"w-5 h-5 text-yellow-500"}):(0,t.jsx)(_,{className:"w-5 h-5 text-gray-600"})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>x(!c),className:"p-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors relative",children:[(0,t.jsx)(z,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"}),K.length>0&&(0,t.jsx)("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full ring-2 ring-white dark:ring-gray-800"})]}),c&&(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 z-50",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-gray-900 dark:text-gray-100 font-semibold tracking-tight",children:"Notifications"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium mt-0.5",children:[K.length," unread"]})]}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:K.map(e=>(0,t.jsx)("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-50 dark:border-gray-700 cursor-pointer transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:`w-2 h-2 rounded-full mt-2 ${"warning"===e.type?"bg-yellow-500":"success"===e.type?"bg-green-500":"bg-red-500"}`}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm text-gray-900 dark:text-gray-100 font-medium leading-relaxed",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 font-medium",children:e.time})]})]})},e.id))}),(0,t.jsx)("div",{className:"p-3 text-center border-t border-gray-100 dark:border-gray-700",children:(0,t.jsx)("button",{className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-semibold",children:"View all notifications"})})]})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{ref:P,onClick:()=>o(!n),className:"flex items-center gap-3 pl-2 pr-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",children:[(0,t.jsx)("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-600/20",children:(0,t.jsx)(d.User,{className:"w-5 h-5 text-white"})}),(0,t.jsxs)("div",{className:"hidden md:block text-left",children:[(0,t.jsx)("p",{className:"text-sm text-gray-900 dark:text-gray-100 font-semibold tracking-tight",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:e.role})]}),(0,t.jsx)(y.ChevronDown,{className:"w-4 h-4 text-gray-600 dark:text-gray-400 hidden md:block"})]}),n&&(0,t.jsxs)("div",{ref:L,className:"absolute right-0 mt-2 w-72 bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 z-50",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("p",{className:"text-gray-900 dark:text-gray-100 font-semibold tracking-tight",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium mt-0.5",children:e.role}),e.branch&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 font-medium",children:["Branch: ",e.branch]}),!V&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-2 font-medium",children:"Work Status"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>Z("office_work"),disabled:S,className:`flex-1 px-3 py-2 rounded-lg text-xs font-medium transition-all ${"office_work"===Y?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 ring-2 ring-green-500/30":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"} ${S?"opacity-50 cursor-not-allowed":""}`,children:"Office Work"}),(0,t.jsx)("button",{onClick:()=>Z("on_field"),disabled:S,className:`flex-1 px-3 py-2 rounded-lg text-xs font-medium transition-all ${"on_field"===Y?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300 ring-2 ring-blue-500/30":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"} ${S?"opacity-50 cursor-not-allowed":""}`,children:"On Field"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-2",children:"office_work"===Y?"Working from office":"Working on field / in a meeting"})]})]}),(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsxs)("button",{onClick:i,className:"w-full flex items-center gap-3 px-4 py-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl transition-colors font-medium",children:[(0,t.jsx)(d.User,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm",children:"Profile Settings"})]}),V?(0,t.jsxs)("button",{onClick:X,className:"w-full flex items-center gap-3 px-4 py-2.5 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-colors mt-1 font-medium",children:[(0,t.jsx)(R,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm",children:"Logout"})]}):(0,t.jsxs)("button",{onClick:()=>u(!0),className:"w-full flex items-center gap-3 px-4 py-2.5 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-colors mt-1 font-medium",children:[(0,t.jsx)(R,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm",children:"End Work Day"})]})]})]})]})]})]})]})}function V({children:e}){let[s,l]=(0,r.useState)(!1),i=(0,O.usePathname)(),n=(0,O.useRouter)(),{isDarkMode:o}=W(),[d,c]=(0,r.useState)(null),[x,g]=(0,r.useState)(!0);if((0,r.useEffect)(()=>{(async()=>{if("/login"===i||"/forgot-password"===i||"/reset-password"===i)return g(!1);if(!a.authService.isAuthenticated()){n.push("/login"),g(!1);return}try{let e=a.authService.getCurrentUser();if(e){let t=localStorage.getItem("roles"),r=e.role;if(t)try{let e=JSON.parse(t);Array.isArray(e)&&e.length>0&&(r=e[0].name)}catch(e){console.error("Failed to parse roles",e)}c({name:e.name,role:r||"Staff",branch:"Head Office"})}else{await a.authService.refreshProfile();let e=a.authService.getCurrentUser();e?c({name:e.name,role:(localStorage.getItem("roles")?JSON.parse(localStorage.getItem("roles"))[0]?.name:null)||"Staff",branch:"Head Office"}):(a.authService.logout(),n.push("/login"))}}catch(e){console.error("Auth check failed",e),n.push("/login")}finally{g(!1)}})()},[i,n]),x)return(0,t.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50 dark:bg-gray-900",children:(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Securing session..."})]})});if("/login"===i||"/forgot-password"===i||"/reset-password"===i||!d)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.ToastContainer,{position:"top-right",autoClose:3e3,theme:o?"dark":"light",hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),e]});let u=async()=>{try{await a.authService.logout(),n.push("/login")}catch(e){console.error("Logout failed",e),n.push("/login")}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.ToastContainer,{position:"top-right",autoClose:3e3,theme:o?"dark":"light",hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[(0,t.jsx)(F,{currentPage:(()=>{if("/"===i||"/dashboard"===i)return"dashboard";if("/customers/requests"===i)return"customer-requests";let e=i.split("/").filter(Boolean);return e.length>0?e[0]:"dashboard"})(),onNavigate:e=>{let t={dashboard:"/",branches:"/branches",centers:"/centers","meeting-scheduling":"/meeting-scheduling",groups:"/groups",customers:"/customers","loan-create":"/loans/create","loan-approval":"/loans/approval","loan-sent-back":"/loans/sent-back","loan-list":"/loans","loan-product":"/loan-product","roles-privileges":"/roles-privileges","customer-requests":"/customers/requests","receipt-rejections":"/collections/rejections"}[e]||`/${e}`;n.push(t)},isOpen:s,userRole:d.role}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,t.jsx)(H,{user:d,onLogout:u,onToggleSidebar:()=>l(!s)}),(0,t.jsx)("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 dark:bg-gray-900",children:e})]})]})]})}function Y({children:e}){return(0,t.jsx)(U,{children:(0,t.jsx)(V,{children:e})})}e.s(["MainLayout",()=>Y],28475)}]);
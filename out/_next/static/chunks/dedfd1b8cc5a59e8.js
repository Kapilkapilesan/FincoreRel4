(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95468,e=>{"use strict";let r=(0,e.i(75254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>r],95468)},73884,e=>{"use strict";let r=(0,e.i(75254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>r],73884)},25411,e=>{"use strict";var r=e.i(43476),a=e.i(71645),t=e.i(81418),s=e.i(95468),l=e.i(73884),d=e.i(84614);let i=(0,e.i(75254).default)("Diff",[["path",{d:"M12 3v14",key:"7cf3v8"}],["path",{d:"M5 10h14",key:"elsbfy"}],["path",{d:"M5 21h14",key:"11awu3"}]]);var n=e.i(70319),c=e.i(64397);let o=async()=>{let e=await fetch(`${c.API_BASE_URL}/customer-edit-requests`,{headers:(0,c.getHeaders)()}),r=await e.json();if(!e.ok)throw Error(r.message||"Failed to fetch pending requests");return r},x=async e=>{let r=await fetch(`${c.API_BASE_URL}/customer-edit-requests/${e}/approve`,{method:"POST",headers:(0,c.getHeaders)()}),a=await r.json();if(!r.ok)throw Error(a.message||"Failed to approve request");return a},u=async(e,r)=>{let a=await fetch(`${c.API_BASE_URL}/customer-edit-requests/${e}/reject`,{method:"POST",headers:(0,c.getHeaders)(),body:JSON.stringify({reason:r})}),t=await a.json();if(!a.ok)throw Error(t.message||"Failed to reject request");return t};var h=e.i(42365);function g(){let[e,c]=(0,a.useState)([]),[g,m]=(0,a.useState)(!0),[b,y]=(0,a.useState)(null),[p,f]=(0,a.useState)({isOpen:!1,requestId:null,reason:""}),[j,k]=(0,a.useState)({isOpen:!1,requestId:null});h.authService.hasRole("manager")||h.authService.hasRole("admin")||h.authService.hasRole("super_admin"),(0,a.useEffect)(()=>{v()},[]);let v=async()=>{m(!0);try{let e=await o();c(e.data)}catch(e){console.error("Failed to load requests",e),n.toast.error("Failed to load requests")}finally{m(!1)}},w=async()=>{if(!j.requestId)return;let e=j.requestId;y(e);try{await x(e),n.toast.success("Customer profile updated successfully"),k({isOpen:!1,requestId:null}),v()}catch(e){n.toast.error(e.message||"Failed to approve")}finally{y(null)}},N=async()=>{if(p.requestId&&p.reason.trim()){y(p.requestId);try{await u(p.requestId,p.reason),n.toast.success("Request rejected"),f({isOpen:!1,requestId:null,reason:""}),v()}catch(e){n.toast.error(e.message||"Failed to reject")}finally{y(null)}}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200 p-6",children:[(0,r.jsxs)("main",{className:"max-w-6xl mx-auto space-y-8",children:[(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-black text-gray-900 dark:text-white tracking-tight flex items-center gap-3",children:[(0,r.jsx)(t.ShieldCheck,{className:"w-8 h-8 text-blue-600"}),"Profile Edit Approvals"]}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-2 font-medium",children:"Review and approve customer detail corrections for active accounts"})]})}),g?(0,r.jsx)("div",{className:"flex justify-center py-20",children:(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):0===e.length?(0,r.jsxs)("div",{className:"text-center py-20 bg-white dark:bg-gray-800 rounded-3xl border border-dashed border-gray-300 dark:border-gray-700",children:[(0,r.jsx)(s.CheckCircle2,{className:"w-16 h-16 text-green-200 dark:text-green-900/40 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Caught Up!"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"No pending customer edit requests at this time."})]}):(0,r.jsx)("div",{className:"grid gap-6",children:e.map(e=>{var a,t;let n,c,o=(a=e.old_data,t=e.new_data,n=[],c=["updated_at","created_at","id","branch","center","group","loans"],Object.keys(t).forEach(e=>{c.includes(e)||t[e]!==a[e]&&n.push({field:e.replace(/_/g," ").toUpperCase(),oldValue:a[e],newValue:t[e]})}),n);return(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700/50 hover:shadow-md transition-all",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,r.jsxs)("div",{className:"lg:w-1/3 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center text-blue-600",children:(0,r.jsx)(d.User,{size:24})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:e.customer?.full_name}),(0,r.jsx)("p",{className:"text-sm text-gray-500 font-mono tracking-tighter",children:e.customer?.customer_code})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,r.jsx)("span",{className:"text-gray-400 font-bold uppercase",children:"Requested By"}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-200 font-bold",children:e.requester?.user_name})]}),(0,r.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,r.jsx)("span",{className:"text-gray-400 font-bold uppercase",children:"Date"}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-200",children:new Date(e.created_at).toLocaleString()})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,r.jsxs)("button",{onClick:()=>{k({isOpen:!0,requestId:e.id})},disabled:!!b,className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-sm shadow-lg shadow-blue-500/20 active:scale-95 transition-all flex items-center justify-center gap-2",children:[(0,r.jsx)(s.CheckCircle2,{size:18}),"Approve"]}),(0,r.jsxs)("button",{onClick:()=>{f({isOpen:!0,requestId:e.id,reason:""})},disabled:!!b,className:"flex-1 py-3 bg-red-50 dark:bg-red-900/20 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/40 rounded-xl font-bold text-sm transition-all flex items-center justify-center gap-2",children:[(0,r.jsx)(l.XCircle,{size:18}),"Reject"]})]})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4 text-xs font-black text-gray-400 uppercase tracking-widest",children:[(0,r.jsx)(i,{size:14}),"Changes Highlight (",o.length,")"]}),(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-2xl overflow-hidden border border-gray-100 dark:border-gray-700/50",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 dark:bg-gray-800 text-[10px] font-black uppercase text-gray-500 tracking-wider",children:[(0,r.jsx)("th",{className:"px-4 py-3 text-left",children:"Property"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left",children:"Previous State"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left",children:"Proposed State"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:o.map((e,a)=>(0,r.jsxs)("tr",{className:"group hover:bg-white dark:hover:bg-gray-800/50 transition-colors",children:[(0,r.jsx)("td",{className:"px-4 py-3 font-bold text-gray-500 dark:text-gray-400 text-xs",children:e.field}),(0,r.jsx)("td",{className:"px-4 py-3 text-gray-500 line-through decoration-red-400/50",children:e.oldValue||(0,r.jsx)("span",{className:"italic text-gray-300",children:"empty"})}),(0,r.jsx)("td",{className:"px-4 py-3 text-blue-600 dark:text-blue-400 font-semibold bg-blue-50/30 dark:bg-blue-900/10",children:e.newValue})]},a))})]})})]})]})},e.id)})})]}),p.isOpen&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-[150] p-4 animate-in fade-in duration-200",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-3xl max-w-md w-full shadow-2xl overflow-hidden scale-in-95 animate-in duration-200",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700 flex items-center gap-3",children:[(0,r.jsx)(l.XCircle,{className:"text-red-500"}),(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Reject Request"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Please provide a reason why you are rejecting these profile changes."}),(0,r.jsx)("textarea",{value:p.reason,onChange:e=>f({...p,reason:e.target.value}),className:"w-full p-4 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none min-h-[120px] transition-all",placeholder:"Example: Incorrect NIC format, Wrong family count...",autoFocus:!0})]}),(0,r.jsxs)("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-100 dark:border-gray-700 flex justify-end gap-3",children:[(0,r.jsx)("button",{onClick:()=>f({isOpen:!1,requestId:null,reason:""}),className:"px-6 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-sm font-bold",children:"Cancel"}),(0,r.jsx)("button",{onClick:N,disabled:!p.reason.trim()||!!b,className:"px-8 py-2 bg-red-600 hover:bg-red-700 text-white rounded-xl text-sm font-bold shadow-lg shadow-red-500/20 active:scale-95 transition-all",children:b?"Processing...":"Confirm Reject"})]})]})}),j.isOpen&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-[150] p-4 animate-in fade-in duration-200",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-3xl max-w-md w-full shadow-2xl overflow-hidden scale-in-95 animate-in duration-200",children:[(0,r.jsxs)("div",{className:"p-8 text-center space-y-4",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center text-blue-600 mx-auto mb-2 animate-bounce",children:(0,r.jsx)(t.ShieldCheck,{size:40})}),(0,r.jsx)("h2",{className:"text-2xl font-black text-gray-900 dark:text-white",children:"Approve Changes?"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 font-medium leading-relaxed",children:"Are you sure you want to approve these profile corrections? The customer's information will be updated immediately."})]}),(0,r.jsxs)("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-100 dark:border-gray-700 flex flex-col gap-3",children:[(0,r.jsx)("button",{onClick:w,disabled:!!b,className:"w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl font-black text-base shadow-xl shadow-blue-500/25 active:scale-[0.98] transition-all flex items-center justify-center gap-2",children:b?(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.CheckCircle2,{size:20}),"Confirm & Apply Changes"]})}),(0,r.jsx)("button",{onClick:()=>k({isOpen:!1,requestId:null}),className:"w-full py-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 font-bold transition-colors",children:"Take me back"})]})]})})]})}e.s(["default",()=>g],25411)}]);
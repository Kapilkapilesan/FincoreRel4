(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,46523,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(55436),a=e.i(7233),l=e.i(61911),i=e.i(13477),n=e.i(64397),d=e.i(37727),c=e.i(27612),o=e.i(31278),x=e.i(75254);let u=(0,x.default)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);function m({isOpen:e,onClose:r,onSubmit:l,initialData:x}){let[m,h]=(0,s.useState)([]),[g,p]=(0,s.useState)([]),[b,f]=(0,s.useState)([]),[y,j]=(0,s.useState)(!1),[v,N]=(0,s.useState)(""),[S,w]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("roles");if(e)try{let t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){let e=t.map(e=>e.name);e.includes("field_officer")?N("field_officer"):e.includes("super_admin")?N("super_admin"):e.includes("admin")?N("admin"):N(e[0])}}catch(e){console.error("Error parsing roles",e)}let t=localStorage.getItem("user");if(t)try{w(JSON.parse(t))}catch(e){console.error("Error parsing user",e)}},[]),(0,s.useEffect)(()=>{let t=localStorage.getItem("roles");if(t)try{let e=JSON.parse(t);if(Array.isArray(e)&&e.length>0){let t=e.map(e=>e.name);t.includes("field_officer")?N("field_officer"):t.includes("super_admin")?N("super_admin"):t.includes("admin")?N("admin"):N(t[0])}}catch(e){console.error("Error parsing roles",e)}(async()=>{if(!e)return;let t=localStorage.getItem("roles"),s=[];if(t)try{s=JSON.parse(t).map(e=>e.name)}catch(e){console.error("Error parsing roles",e)}j(!0);try{let[e,t]=await Promise.all([i.branchService.getBranchesAll(),fetch(`${n.API_BASE_URL}/staffs/by-role/field_officer`,{headers:(0,n.getHeaders)()}).then(e=>e.json())]),r=e||[];if(s.includes("field_officer")){let e=localStorage.getItem("user"),t=e?JSON.parse(e):null,s=t?.user_name;if(s)try{let e=(await fetch(`${n.API_BASE_URL}/staffs/${s}`,{headers:(0,n.getHeaders)()}).then(e=>e.json())).data;e&&e.branch_id&&(r=r.filter(t=>String(t.id)===String(e.branch_id)))}catch(e){console.error("Failed to fetch staff details for branch filtering",e)}}p(r),t?.data?f(t.data):Array.isArray(t)&&f(t)}catch(e){console.error("Failed to load form data:",e)}finally{j(!1)}})()},[e]),(0,s.useEffect)(()=>{e&&(x?h(x.open_days||[]):h([]))},[e,x]);let[_,C]=(0,s.useState)(null),k=(e,t,s)=>{let r=[...m];if("date"===t){let a=new Date(s).toLocaleDateString("en-US",{weekday:"long"});r[e]={...r[e],[t]:s,day:a}}else r[e]={...r[e],[t]:s};let a=new Set,l=!1;for(let e of r)if(e.day&&e.time){let t=`${e.day}-${e.time}`;if(a.has(t)){l=!0;break}a.add(t)}l?C("Duplicate schedule entries (same day and time) are not allowed."):C(null),h(r)};return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-white px-6 py-4 border-b border-gray-100 flex items-center justify-between z-10",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:x?"Edit Center":"Create New Center"}),(0,t.jsx)("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500",children:(0,t.jsx)(d.X,{size:24})})]}),y?(0,t.jsxs)("div",{className:"p-20 flex flex-col items-center justify-center space-y-4",children:[(0,t.jsx)(o.Loader2,{size:40,className:"animate-spin text-blue-600"}),(0,t.jsx)("p",{className:"text-gray-500 font-medium",children:"Loading form details..."})]}):(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),_)return;let t=new FormData(e.currentTarget);l({CSU_id:t.get("CSU_id"),center_name:t.get("center_name"),branch_id:t.get("branch_id"),staff_id:"field_officer"===v?S?.user_name||null:t.get("contactPerson")||null,address:t.get("address"),location:t.get("locationType"),status:x?x.status:"field_officer"===v?"inactive":"active",open_days:m,meetingTime:m.length>0?m[0].time:void 0})},className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Center Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"center_name",required:!0,defaultValue:x?.center_name,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter center name"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Branch ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("select",{name:"branch_id",required:!0,defaultValue:x?.branch_id||(1===g.length?g[0].id:""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors bg-white",children:[1!==g.length&&(0,t.jsx)("option",{value:"",children:"Select Branch"}),g.map(e=>(0,t.jsx)("option",{value:e.id,children:e.branch_name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Location Type ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"locationType",required:!0,defaultValue:x?.location,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"e.g. Urban, Rural"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Address ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("textarea",{name:"address",required:!0,defaultValue:x?.address,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none",placeholder:"Full address of the center"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["field_officer"===v?(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Field Officer"}),(0,t.jsxs)("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-semibold text-gray-600 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),S?.full_name||S?.name||"Loading...",(0,t.jsxs)("span",{className:"text-[10px] text-gray-400 font-mono",children:["(",S?.user_name||"...",")"]})]}),(0,t.jsx)("input",{type:"hidden",name:"contactPerson",value:S?.user_name||""}),(0,t.jsx)("p",{className:"text-[10px] text-blue-600 italic",children:"Self-assigned as creating officer."})]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Field Officer ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("select",{name:"contactPerson",defaultValue:x?.staff_id||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors bg-white",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select Officer"}),b.map(e=>(0,t.jsx)("option",{value:e.staff_id,children:e.full_name},e.staff_id))]})]}),x&&"field_officer"!==v?(0,t.jsxs)("div",{className:"p-3 bg-blue-50 border border-blue-100 rounded-lg flex flex-col justify-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-blue-700 font-bold text-xs uppercase tracking-tighter",children:[(0,t.jsx)(u,{size:14}),"Center Status"]}),(0,t.jsx)("p",{className:"text-[10px] text-blue-600 mt-1",children:"Status management is now handled via the action buttons in the center table."})]}):x||"field_officer"!==v?null:(0,t.jsxs)("div",{className:"p-3 bg-amber-50 border border-amber-100 rounded-lg flex flex-col justify-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-amber-700 font-bold text-xs uppercase tracking-tighter",children:[(0,t.jsx)(u,{size:14}),"Approval Required"]}),(0,t.jsxs)("p",{className:"text-[10px] text-amber-600 mt-1",children:["This center will be saved as ",(0,t.jsx)("span",{className:"font-bold",children:"Pending"})," and requires manager activation."]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Meeting Schedules"}),"field_officer"!==v&&(0,t.jsxs)("button",{type:"button",onClick:()=>{h([...m,{day:"",date:new Date().toISOString().split("T")[0],time:"10:00"}])},className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1 hover:bg-blue-50 px-2 py-1 rounded transition-colors",children:[(0,t.jsx)(a.Plus,{size:16})," Add Schedule"]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[m.map((e,s)=>(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center animate-in fade-in slide-in-from-top-1 duration-200 bg-white p-3 rounded-lg border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex-1 w-full sm:w-auto",children:[(0,t.jsx)("label",{className:"block text-[10px] uppercase font-bold text-gray-400 mb-1",children:"Day"}),"field_officer"===v?(0,t.jsx)("input",{type:"text",value:e.day,readOnly:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 outline-none font-medium cursor-default"}):(0,t.jsxs)("select",{value:e.day,onChange:e=>k(s,"day",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select Day"}),["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"w-full sm:w-32",children:[(0,t.jsx)("label",{className:"block text-[10px] uppercase font-bold text-gray-400 mb-1",children:"Time"}),(0,t.jsx)("input",{type:"time",value:e.time,onChange:e=>k(s,"time",e.target.value),readOnly:"field_officer"===v,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none ${"field_officer"===v?"bg-gray-50 cursor-default":""}`})]}),"field_officer"!==v&&(0,t.jsx)("div",{className:"pt-5 sm:pt-0",children:(0,t.jsx)("button",{type:"button",onClick:()=>{h(m.filter((e,t)=>t!==s))},className:"text-gray-400 hover:text-red-500 p-2 rounded-lg hover:bg-red-50 transition-colors",title:"Remove schedule",children:(0,t.jsx)(c.Trash2,{size:18})})})]},s)),(0===m.length||"field_officer"===v)&&(0,t.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm italic bg-white rounded border border-dashed border-gray-300",children:"field_officer"===v?"Meeting schedules are managed exclusively by Managers.":"No meeting schedules configured"}),_&&(0,t.jsxs)("div",{className:"text-red-500 text-xs font-semibold mt-2 flex items-center gap-1",children:[(0,t.jsx)(u,{size:12}),_]})]})]}),(0,t.jsxs)("div",{className:"sticky bottom-0 bg-white pt-4 border-t border-gray-100 flex gap-3 justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium text-sm transition-colors",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm transition-colors flex items-center gap-2",children:x?"rejected"===x.status?"Resubmit Request":"Update Center":"Create Center"})]})]})]})}):null}var h=e.i(84614),g=e.i(78894),p=e.i(81203),b=e.i(99655),f=e.i(13130),y=e.i(4405);function j({centers:e,totalCenters:s,getTemporaryAssignment:r,onEdit:a,onViewSchedule:i,onApprove:n,onReject:d,onViewDetails:o,onDelete:x,onToggleStatus:u,isFieldOfficer:m,isManager:j,isSuperAdmin:v}){let{currentPage:N,itemsPerPage:S,startIndex:w,endIndex:_,handlePageChange:C,handleItemsPerPageChange:k}=(0,f.usePagination)({totalItems:e.length}),R=e.slice(w,_);return(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4 text-xs font-semibold text-gray-600 uppercase",children:[(0,t.jsx)("div",{className:"col-span-2",children:"Center"}),(0,t.jsx)("div",{className:"col-span-1",children:"Branch"}),(0,t.jsx)("div",{className:"col-span-2",children:"Meeting Schedule"}),(0,t.jsx)("div",{className:"col-span-2 text-center",children:"Assigned User"}),(0,t.jsx)("div",{className:"col-span-1 text-center",children:"Location"}),(0,t.jsx)("div",{className:"col-span-1 text-center",children:"Status"}),(0,t.jsx)("div",{className:"col-span-3 text-right",children:"Actions"})]})}),(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:0===R.length?(0,t.jsx)("div",{className:"px-6 py-8 text-center text-gray-500 text-sm",children:"No centers found."}):R.map(e=>{let s=r(e.id);return(0,t.jsxs)("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:[(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center",children:[(0,t.jsxs)("div",{className:"col-span-2 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:b.colors.primary[50]},children:(0,t.jsx)(l.Users,{className:"w-5 h-5",style:{color:b.colors.primary[600]}})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("button",{onClick:()=>o(e),className:"text-sm font-bold text-gray-900 truncate hover:text-blue-600 transition-colors block text-left w-full",children:e.center_name}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.CSU_id})]})]}),(0,t.jsx)("div",{className:"col-span-1",children:(0,t.jsx)("p",{className:"text-sm text-gray-900",children:e.branch?.branch_name||e.branch_id})}),(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsxs)("div",{className:"space-y-1",children:[e.open_days?.slice(0,3).map((e,s)=>(0,t.jsx)("div",{className:"flex flex-col text-xs",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:e.day}),(0,t.jsx)("span",{className:"text-gray-500",children:e.time})]})},s)),(e.open_days?.length||0)>3&&(0,t.jsxs)("span",{className:"text-[10px] text-gray-400 font-medium italic mt-1 block",children:["+",(e.open_days?.length||0)-3," more"]})]})}),(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center",children:(0,t.jsx)(h.User,{className:"w-3 h-3 text-gray-600"})}),(0,t.jsx)("div",{className:"min-w-0",children:(0,t.jsx)("p",{className:"text-xs font-medium text-gray-900 truncate",children:e.staff?.full_name||e.staff_id||"Unassigned"})})]})}),(0,t.jsx)("div",{className:"col-span-1 text-center",children:(0,t.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"Urban"===e.location?"bg-blue-100 text-blue-800":"Rural"===e.location?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:e.location})}),(0,t.jsx)("div",{className:"col-span-1",children:(0,t.jsx)("div",{className:"flex flex-col items-center gap-1",children:(0,t.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full capitalize ${"active"===e.status?"bg-green-100 text-green-800 border border-green-200":"rejected"===e.status?"bg-red-100 text-red-800 border border-red-200":"disabled"===e.status?"bg-gray-100 text-gray-700 border border-gray-300":"bg-amber-100 text-amber-800 border border-amber-200"}`,children:"inactive"===e.status?"Pending":e.status})})}),(0,t.jsxs)("div",{className:"col-span-3 flex justify-end gap-1 text-right",children:[u&&"active"===e.status&&(0,t.jsx)("button",{onClick:()=>u(e),className:"p-1.5 rounded transition-colors hover:bg-amber-50 text-amber-600",title:"Disable Center",children:(0,t.jsx)(p.Power,{className:"w-3.5 h-3.5"})}),u&&"disabled"===e.status&&(j||v)&&(0,t.jsx)("button",{onClick:()=>u(e),className:"p-1.5 rounded transition-colors hover:bg-green-50 text-green-600",title:"Enable Center",children:(0,t.jsx)(p.Power,{className:"w-3.5 h-3.5"})}),"inactive"===e.status&&n&&(0,t.jsx)("button",{onClick:()=>n(e.id),className:"p-1 px-2 text-xs font-medium bg-blue-600 text-white hover:bg-blue-700 rounded transition-colors",children:"Approve"}),"inactive"===e.status&&d&&(0,t.jsx)("button",{onClick:()=>d(e.id),className:"p-1 px-2 text-xs font-medium text-red-600 hover:bg-red-50 rounded transition-colors",children:"Reject"}),("rejected"!==e.status||m)&&(0,t.jsx)("button",{onClick:()=>a(e.id),className:"p-1 px-2 text-xs font-medium text-gray-600 hover:bg-gray-100 rounded transition-colors",children:"Edit"}),x&&"inactive"===e.status&&m&&0===(e.groups_count||0)&&0===(e.customers_count||0)&&(!e.open_days||0===e.open_days.length)&&(0,t.jsx)("button",{onClick:()=>x(e.id),className:"p-1 px-2 text-xs font-medium text-red-600 hover:bg-red-50 rounded transition-colors group relative",title:"Delete Center",children:(0,t.jsx)(c.Trash2,{size:14})})]})]}),s&&(0,t.jsx)("div",{className:"col-span-12 mt-3 bg-orange-50 border border-orange-200 rounded-lg p-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(g.AlertTriangle,{className:"w-5 h-5 text-orange-600 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-orange-900",children:"Temporary Assignment Active"}),(0,t.jsxs)("p",{className:"text-sm text-orange-800",children:[s.originalUser," is unavailable. ",s.temporaryUser," assigned for ",s.date,"."]}),s.reason&&(0,t.jsxs)("p",{className:"text-xs text-orange-700 mt-1",children:["Reason: ",s.reason]})]})]})})]},e.id)})}),(0,t.jsx)(y.Pagination,{currentPage:N,totalItems:e.length,itemsPerPage:S,onPageChange:C,onItemsPerPageChange:k,itemName:"centers"})]})}var v=e.i(46897),N=e.i(87316),S=e.i(7486),w=e.i(3116);let _=(0,x.default)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var C=e.i(69638),k=e.i(92930),R=e.i(63209);function A({center:e,isOpen:s,onClose:r,onApprove:a,onReject:i,onEdit:n,onDelete:o,isFieldOfficer:x}){return s?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden animate-in zoom-in-95 duration-200 border border-gray-100",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-white sticky top-0 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:b.colors.primary[50]},children:(0,t.jsx)(l.Users,{className:"w-5 h-5",style:{color:b.colors.primary[600]}})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-900 leading-tight",children:e.center_name}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500 font-mono tracking-wider",children:e.CSU_id})]})]}),(0,t.jsx)("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-400 hover:text-gray-600",children:(0,t.jsx)(d.X,{size:20})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6 max-h-[75vh] overflow-y-auto custom-scrollbar",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl border border-gray-100",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase font-bold text-gray-400 tracking-wider",children:"Status"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${"active"===e.status?"bg-green-500 animate-pulse":"rejected"===e.status?"bg-red-500":"bg-amber-500"}`}),(0,t.jsx)("span",{className:`text-sm font-bold ${"active"===e.status?"text-green-700":"rejected"===e.status?"text-red-700":"text-amber-700"}`,children:"inactive"===e.status?"Pending Approval":e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})]}),(0,t.jsxs)("div",{className:"text-right space-y-0.5",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase font-bold text-gray-400 tracking-wider",children:"Groups"}),(0,t.jsxs)("p",{className:"text-sm font-bold text-gray-900",children:[e.group_count||0," Registered"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-x-8 gap-y-6",children:[(0,t.jsx)(P,{label:"Associated Branch",value:e.branch?.branch_name||e.branch_id,icon:(0,t.jsx)(S.Building2,{size:14})}),(0,t.jsx)(P,{label:"Location Context",value:e.location||"N/A",icon:(0,t.jsx)(v.MapPin,{size:14})}),(0,t.jsx)(P,{label:"Assigned Officer",value:e.staff?.full_name||"Unassigned",icon:(0,t.jsx)(h.User,{size:14})}),(0,t.jsx)(P,{label:"Contact ID",value:e.staff_id||"N/A",icon:(0,t.jsx)(_,{size:14})})]}),"rejected"===e.status&&e.rejection_reason&&(0,t.jsxs)("div",{className:"overflow-hidden rounded-2xl border border-red-100 bg-red-50/50 shadow-sm animate-in slide-in-from-top-2 duration-300",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-red-100/50 border-b border-red-100",children:[(0,t.jsx)(R.AlertCircle,{size:14,className:"text-red-600"}),(0,t.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest text-red-700",children:"Official Feedback"})]}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("p",{className:"text-sm font-medium leading-relaxed text-red-900 italic",children:['"',e.rejection_reason,'"']})})]}),(0,t.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 uppercase text-[10px] font-bold tracking-widest border-b border-gray-50 pb-2",children:[(0,t.jsx)(N.Calendar,{size:12}),(0,t.jsx)("span",{children:"Meeting Schedule"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-2",children:e.open_days&&e.open_days.length>0?e.open_days.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-100 hover:border-blue-200 transition-colors group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gray-50 group-hover:bg-blue-50 flex items-center justify-center text-gray-400 group-hover:text-blue-600 transition-colors",children:(0,t.jsx)(w.Clock,{size:16})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-bold text-gray-800",children:e.day}),e.date&&(0,t.jsx)("p",{className:"text-[10px] text-gray-400",children:e.date})]})]}),(0,t.jsx)("div",{className:"px-2 py-1 bg-gray-50 rounded text-xs font-mono font-bold text-gray-600 group-hover:bg-blue-50 group-hover:text-blue-700 transition-colors",children:e.time})]},s)):(0,t.jsx)("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-dashed border-gray-200",children:(0,t.jsx)("p",{className:"text-xs text-gray-400 italic font-medium",children:"No schedules configured for this center"})})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 uppercase text-[10px] font-bold tracking-widest border-b border-gray-50 pb-2",children:[(0,t.jsx)(v.MapPin,{size:12}),(0,t.jsx)("span",{children:"Geographic Address"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed bg-blue-50/30 p-4 rounded-xl border border-blue-50/50 italic",children:e.address||"No address details provided for this location."})]})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 border-t border-gray-100 flex items-center justify-between gap-3 z-10",children:[(0,t.jsx)("div",{className:"flex-1",children:"inactive"===e.status&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-[10px] text-amber-600 font-bold italic",children:[(0,t.jsx)(u,{size:10}),"Awaiting Approval"]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:r,className:"px-4 py-2 border border-gray-200 text-gray-600 rounded-lg text-xs font-bold hover:bg-white transition-colors",children:"Close"}),o&&"inactive"===e.status&&x&&0===(e.groups_count||0)&&0===(e.customers_count||0)&&(!e.open_days||0===e.open_days.length)&&(0,t.jsxs)("button",{onClick:()=>{o(e.id),r()},className:"px-4 py-2 border border-red-200 bg-red-50 text-red-700 rounded-lg text-xs font-bold hover:bg-red-100 transition-colors flex items-center gap-1.5",children:[(0,t.jsx)(c.Trash2,{size:14}),"Delete Request"]}),n&&("rejected"!==e.status||x)&&(0,t.jsxs)("button",{onClick:()=>{n(e.id),r()},className:"px-4 py-2 border border-blue-200 bg-blue-50 text-blue-700 rounded-lg text-xs font-bold hover:bg-blue-100 transition-colors flex items-center gap-1.5",children:[(0,t.jsx)(k.Edit2,{size:14}),"Edit"]}),"inactive"===e.status&&i&&(0,t.jsxs)("button",{onClick:()=>{i(e.id),r()},className:"px-4 py-2 border border-red-200 bg-red-50 text-red-700 rounded-lg text-xs font-bold hover:bg-red-100 transition-colors flex items-center gap-1.5",children:[(0,t.jsx)(d.X,{size:14}),"Reject Request"]}),"inactive"===e.status&&a&&(0,t.jsxs)("button",{onClick:()=>{a(e.id),r()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-xs font-bold hover:bg-blue-700 transition-colors shadow-md shadow-blue-200 flex items-center gap-1.5",children:[(0,t.jsx)(C.CheckCircle,{size:14}),"Approve Center"]})]})]})]})}):null}function P({label:e,value:s,icon:r}){return e?(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-gray-400 uppercase text-[9px] font-black tracking-tighter",children:[r,(0,t.jsx)("span",{children:String(e)})]}),(0,t.jsx)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:null!=s?String(s):"N/A"})]}):null}var z=e.i(658),T=e.i(70319),F=e.i(42365);let O=(0,x.default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function U({isOpen:e,onClose:r,onConfirm:a,centerName:l}){let[i,n]=(0,s.useState)("Requirements not met. Please recreate with correct documents."),[c,x]=(0,s.useState)(!1);if(!e)return null;let u=async e=>{if(e.preventDefault(),i.trim()){x(!0);try{await a(i),r()}catch(e){console.error("Rejection failed:",e)}finally{x(!1)}}};return(0,t.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-200 border border-gray-100",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-white sticky top-0 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-red-50 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(R.AlertCircle,{className:"w-5 h-5 text-red-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-900 leading-tight",children:"Reject Center"}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500 font-medium uppercase tracking-wider",children:l})]})]}),(0,t.jsx)("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-400 hover:text-gray-600",children:(0,t.jsx)(d.X,{size:20})})]}),(0,t.jsxs)("form",{onSubmit:u,children:[(0,t.jsx)("div",{className:"p-6 space-y-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[(0,t.jsx)(O,{size:12}),"Rejection Message"]}),(0,t.jsx)("textarea",{value:i,onChange:e=>n(e.target.value),placeholder:"Explain why this center is being rejected...",className:"w-full min-h-[120px] p-4 bg-gray-50 border border-gray-200 rounded-xl text-sm text-gray-700 focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all outline-none resize-none font-medium italic",required:!0,autoFocus:!0}),(0,t.jsx)("p",{className:"text-[10px] text-gray-400 font-medium italic",children:"* This message will be shown to the Field Officer for rectification."})]})}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 border-t border-gray-100 flex items-center justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"px-5 py-2.5 text-gray-600 rounded-xl text-xs font-bold hover:bg-white border border-transparent hover:border-gray-200 transition-all",children:"Back"}),(0,t.jsxs)("button",{type:"submit",disabled:c||!i.trim(),className:"flex items-center gap-2 px-6 py-2.5 bg-red-600 text-white rounded-xl text-xs font-bold hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg shadow-red-100",children:[c?(0,t.jsx)(o.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(d.X,{size:14}),"Reject Center"]})]})]})]})})}function q(){let[e,i]=(0,s.useState)([]),[n,d]=(0,s.useState)(!0),[c,o]=(0,s.useState)(null),[x,u]=(0,s.useState)(!1),[h,g]=(0,s.useState)(null),[p,b]=(0,s.useState)("");(0,s.useEffect)(()=>{f()},[]);let f=async()=>{try{d(!0);let e=await z.centerService.getCenters();i(e)}catch(e){console.error("Failed to load centers:",e),o(e.message||"Failed to load centers. Please check your connection.")}finally{d(!1)}},[y,v]=(0,s.useState)(!1),[N,S]=(0,s.useState)(null),[w,_]=(0,s.useState)(null),[C,k]=(0,s.useState)(!1),R=async t=>{try{if(N){let s=await z.centerService.updateCenter(N.id,t);i(e.map(e=>String(e.id)===String(s.id)?s:e)),T.toast.success("Center updated successfully!")}else{let s=await z.centerService.createCenter(t);i([...e,s]),T.toast.success("Center created successfully!")}v(!1),S(null)}catch(t){console.error("Failed to save center:",t);let e=t.errors?Object.values(t.errors).flat().join(", "):t.message||"Failed to save center";throw T.toast.error(e),t}},P=t=>{let s=e.find(e=>String(e.id)===String(t));s&&(S(s),v(!0))},[O]=(0,s.useState)(()=>{{let e=localStorage.getItem("temporaryAssignments");return e?JSON.parse(e):[]}}),[q,E]=(0,s.useState)(""),[D,L]=(0,s.useState)(""),[M,I]=(0,s.useState)("active"),$=e.filter(e=>{let t=e.center_name.toLowerCase().includes(q.toLowerCase())||e.CSU_id.toLowerCase().includes(q.toLowerCase())||String(e.branch_id).toLowerCase().includes(q.toLowerCase()),s=!D||e.open_days&&e.open_days.some(e=>e.day===D),r=e.status===M;return t&&s&&r}),B=e.filter(e=>"inactive"===e.status).length,V=e.filter(e=>"rejected"===e.status).length,J=e.filter(e=>"disabled"===e.status).length;if(n)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});if(c)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] text-red-600",children:[(0,t.jsx)("p",{children:c}),(0,t.jsx)("button",{onClick:f,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm",children:"Retry"})]});let X=async t=>{if(!F.authService.hasPermission("centers.approve")&&!F.authService.hasRole("super_admin")&&!F.authService.hasRole("manager")||F.authService.hasRole("admin"))return void T.toast.error("You do not have permission to approve centers");try{let s=await z.centerService.approveCenter(t);i(e.map(e=>String(e.id)===String(s.id)?s:e)),T.toast.success("Center approved successfully!")}catch(e){console.error("Failed to approve center:",e),T.toast.error(e.message||"Failed to approve center")}},H=t=>{if(!F.authService.hasPermission("centers.approve")&&!F.authService.hasRole("super_admin")&&!F.authService.hasRole("manager")||F.authService.hasRole("admin"))return void T.toast.error("You do not have permission to reject requests");let s=e.find(e=>String(e.id)===String(t));s&&(g(String(t)),b(s.center_name),u(!0))},G=async e=>{if(h)try{await z.centerService.rejectCenter(h,e);let t=await z.centerService.getCenters();i(t),T.toast.success("Request marked as rejected."),u(!1),g(null)}catch(e){throw console.error("Failed to reject request:",e),T.toast.error(e.message||"Failed to reject request"),e}},K=async e=>{try{await z.centerService.toggleCenterStatus(e.id,e.status),T.toast.success(`Center ${"active"===e.status?"disabled":"enabled"} successfully!`),f()}catch(t){console.error("Failed to update center status:",t);let e=t.errors?Object.values(t.errors).flat().join(", "):t.message||"Failed to update center status";T.toast.error(e)}},W=async t=>{if(window.confirm("Are you sure you want to delete this center?"))try{await z.centerService.deleteCenter(t),i(e.filter(e=>String(e.id)!==String(t))),T.toast.success("Center deleted successfully!")}catch(e){console.error("Failed to delete center:",e),T.toast.error(e.message||"Failed to delete center")}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Center Scheduling"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"View and manage center meeting schedules"})]}),F.authService.hasPermission("centers.create")&&(0,t.jsxs)("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm",children:[(0,t.jsx)(a.Plus,{className:"w-4 h-4"}),"Create Center"]})]}),(0,t.jsxs)("div",{className:"flex items-center border-b border-gray-200",children:[(0,t.jsx)("button",{onClick:()=>I("active"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"active"===M?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Active Centers"}),(B>0||(F.authService.hasPermission("centers.approve")||F.authService.hasRole("super_admin")||F.authService.hasRole("manager"))&&!F.authService.hasRole("admin"))&&(0,t.jsxs)("button",{onClick:()=>I("inactive"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors flex items-center gap-2 ${"inactive"===M?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Pending Approvals",B>0&&(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-amber-100 text-amber-700 text-[10px] rounded-full font-bold",children:B})]}),(V>0||F.authService.hasRole("field_officer")||(F.authService.hasRole("super_admin")||F.authService.hasRole("manager"))&&!F.authService.hasRole("admin"))&&(0,t.jsxs)("button",{onClick:()=>I("rejected"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors flex items-center gap-2 ${"rejected"===M?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Rejected Requests",V>0&&(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-red-100 text-red-700 text-[10px] rounded-full font-bold",children:V})]}),(J>0||(F.authService.hasRole("super_admin")||F.authService.hasRole("manager"))&&!F.authService.hasRole("admin"))&&(0,t.jsxs)("button",{onClick:()=>I("disabled"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors flex items-center gap-2 ${"disabled"===M?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Disabled Centers",J>0&&(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-700 text-[10px] rounded-full font-bold",children:J})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,t.jsx)("div",{className:"flex-1 min-w-[300px]",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(r.Search,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),(0,t.jsx)("input",{type:"text",placeholder:"Search centers by name, number, or branch...",value:q,onChange:e=>E(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,t.jsx)("div",{className:"min-w-[200px]",children:(0,t.jsxs)("select",{value:D,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"",children:"All Days"}),["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})})]})}),(0,t.jsx)(j,{centers:$,totalCenters:e.length,getTemporaryAssignment:e=>{let t=new Date().toISOString().split("T")[0];return O.find(s=>s.centerId===e&&s.date===t)},onEdit:P,onViewSchedule:e=>console.log("View schedule:",e),onApprove:(F.authService.hasPermission("centers.approve")||F.authService.hasRole("super_admin")||F.authService.hasRole("manager"))&&!F.authService.hasRole("admin")?X:void 0,onReject:(F.authService.hasPermission("centers.approve")||F.authService.hasRole("super_admin")||F.authService.hasRole("manager"))&&!F.authService.hasRole("admin")?H:void 0,onViewDetails:e=>{_(e),k(!0)},onDelete:F.authService.hasPermission("centers.delete")||F.authService.hasRole("field_officer")?W:void 0,onToggleStatus:K,isFieldOfficer:F.authService.hasRole("field_officer"),isManager:F.authService.hasRole("manager"),isSuperAdmin:F.authService.hasRole("super_admin")}),0===$.length&&(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[(0,t.jsx)(l.Users,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No centers found"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Try adjusting your search or filter criteria."})]}),(0,t.jsx)(m,{isOpen:y,onClose:()=>{v(!1),S(null)},initialData:N,onSubmit:R}),w&&(0,t.jsx)(A,{center:w,isOpen:C,onClose:()=>{k(!1),_(null)},onApprove:(F.authService.hasPermission("centers.approve")||F.authService.hasRole("super_admin")||F.authService.hasRole("manager"))&&!F.authService.hasRole("admin")?X:void 0,onReject:(F.authService.hasPermission("centers.approve")||F.authService.hasRole("super_admin")||F.authService.hasRole("manager"))&&!F.authService.hasRole("admin")?H:void 0,onEdit:F.authService.hasPermission("centers.edit")||F.authService.hasRole("super_admin")||F.authService.hasRole("manager")||F.authService.hasRole("admin")?P:void 0,onDelete:F.authService.hasPermission("centers.delete")||F.authService.hasRole("field_officer")?W:void 0,isFieldOfficer:F.authService.hasRole("field_officer")}),(0,t.jsx)(U,{isOpen:x,onClose:()=>u(!1),onConfirm:G,centerName:p})]})}var E=e.i(18566);function D(){let[e,r]=(0,s.useState)(null),a=(0,E.useRouter)();return((0,s.useEffect)(()=>{{let e,t;r((e=F.authService.hasPermission("centers.view"),t=F.authService.hasRole("super_admin"),!!e||!!t||(a.push("/"),!1)))}},[a]),!1===e)?null:null===e?(0,t.jsx)("div",{className:"p-6",children:"Loading schedule..."}):(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(q,{})})}e.s(["default",()=>D],46523)}]);